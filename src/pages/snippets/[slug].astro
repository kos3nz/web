---
import type { CollectionEntry } from 'astro:content'
import { getCollection } from 'astro:content'
import Layout from 'layouts/base.astro'
import Pre from 'ui/astro/pre.astro'
import Tag from 'ui/solidjs/tag.tsx'

interface Props {
  entry: CollectionEntry<'snippets'>
}

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const allSnippets = await getCollection('snippets', ({ data }) => {
    return data.draft !== true
  })

  return allSnippets.map((snippet) => ({
    params: { slug: snippet.slug },
    props: { entry: snippet },
  }))
}

// 2. When it's time to render, you can get the entry directly from the prop
const { entry } = Astro.props
const { Content } = await entry.render()
---

<Layout title={entry.data.title}>
  <div class="flex justify-center">
    <div class="!prose-invert prose-slate prose w-full max-w-4xl space-y-8">
      <h1 class="mt-4 text-center md:text-[42px]">{entry.data.title}</h1>

      <div class="flex justify-center gap-x-2">
        {entry.data.tags.map((tag) => <Tag name={tag} />)}
      </div>

      <article class="prose-code:rounded-md prose-code:p-1 prose-pre:mt-0">
        <Content components={{ pre: Pre }} />
      </article>
    </div>
  </div>
</Layout>
